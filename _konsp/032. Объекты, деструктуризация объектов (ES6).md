# 032. Объекты, деструктуризация объектов (ES6)

	Объекты (они же - ассоциативные массивы, хэши) и работа с ними в Javascript - реализованы не так, как в большинстве языков. С этим связано много ошибок и непоняток.

	Объект в javascript представляет собой обычный ассоциативный массив или, иначе говоря, "хэш". Он хранит любые соответствия "ключ => значение" и имеет несколько стандартных методов.

	Метод объекта в javascript - это просто функция, которая добавлена в ассоциативный массив.

	Все свойства объектов - public, т.е при определении свойства никак нельзя ограничить доступ к свойству. В javascript есть специальные выверты для создания private свойств, связанные с замыканиями. Они рассмотрены вместе с наследованием объектов.

## Как объявить объект:

1. способ объявить объект:
	```javascript
	const obj = new Object();
	const obj = new Object({
		name: 'test'
	});
	```
1. способ объявить объект:
	```javascript
	const obj = {};
	const obj = {
		name: 'test',
	};
	```
---

```javascript
// удалить у объекта "obj" свойство "name"
delete obj.name;
```

```javascript
Object.keys(obj).length; // количество ключей 0 уровня в объекте
```

## деструктуризация объектов:
```javascript
// вытащить свойства объекта в отдельные переменные
let {border, bg} = options.colors;
console.log('{border, bg} =', border, bg );
border = 'yellow';       // не работает
options.colors.bg = 123; // работает
console.log('2 {border, bg} =', border, bg, options );
const {colors} = options;
colors.added = 'added'; // добавит: options.colors.added === 'added'
console.log('3 {colors} =', colors );
console.log('options =', options );
```

## Дескрипторы, геттеры и сеттеры свойств

Основной метод для управления свойствами – `Object.defineProperty()`.

Он позволяет объявить свойство объекта и, что самое главное, тонко настроить его особые аспекты, которые никак иначе не изменить.

Синтаксис:
```javascript
Object.defineProperty(obj, prop, descriptor)
```
Аргументы:
- `obj` - Объект, в котором объявляется свойство.
- `prop` - Имя свойства, которое нужно объявить или модифицировать.
- `descriptor` - Дескриптор – объект, который описывает поведение свойства.

В `descriptor` могут быть следующие поля:
- `value` – значение свойства, по умолчанию `undefined`
-	`writable` – значение свойства можно менять, если `true`. По умолчанию `false`.
- `configurable` – если `true`, то свойство можно удалять, а также менять его в дальнейшем при помощи новых вызовов `defineProperty`. По умолчанию `false`.
- `enumerable` – если `true`, то свойство просматривается в цикле `for..in` и методе `Object.keys()`. По умолчанию `false`.
- `get` – функция, которая возвращает значение свойства. По умолчанию `undefined`.
- `set` – функция, которая записывает значение свойства. По умолчанию `undefined`.

Чтобы избежать конфликта, запрещено одновременно указывать значение `value` и функции `get/set`. Либо значение, либо функции для его чтения-записи, одно из двух. Также запрещено и не имеет смысла указывать `writable` при наличии `get/set`-функций.

```javascript
// Обычное свойство
// Два таких вызова работают одинаково:
var user = {};

// 1. простое присваивание
user.name = "Вася";

// 2. указание значения через дескриптор
Object.defineProperty(user, "name", { value: "Вася", configurable: true, writable: true, enumerable: true });
```

```javascript
// Свойство-константа
"use strict";

var user = {};

Object.defineProperty(user, "name", {
  value: "Вася",
  writable: false, // запретить присвоение "user.name="
  configurable: false // запретить удаление "delete user.name"
});

// Теперь попытаемся изменить это свойство.
// в strict mode присвоение "user.name=" вызовет ошибку
user.name = "Петя";
```

```javascript
// Свойство, скрытое для for…in
var user = {
  name: "Вася",
  toString: function() { return this.name; }
};

// помечаем toString как не подлежащий перебору в for..in
Object.defineProperty(user, "toString", {enumerable: false});

for(var key in user) alert(key);  // name
```

```javascript
```

---
## Ссылки

- устарел! (Деструктуризация) <https://learn.javascript.ru/destructuring#destrukturizatsiya-obekta>
- (Деструктурирующее присваивание) <https://learn.javascript.ru/destructuring-assignment>
- (Объекты Javascript в примерах) <https://javascript.ru/tutorial/object/intro>
- (Дескрипторы, геттеры и сеттеры свойств) <https://learn.javascript.ru/descriptors-getters-setters>
- (Объекты: перебор свойств) <https://learn.javascript.ru/object-for-in>

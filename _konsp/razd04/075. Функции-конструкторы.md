# 075. Функции-конструкторы

## Конструктор, оператор "new"

Обычный синтаксис `{...}` позволяет создать только один объект. Но зачастую нам нужно создать множество похожих, однотипных объектов, таких как пользователи, элементы меню и так далее.

Это можно сделать при помощи функции-конструктора и оператора "`new`".

### Функция-конструктор

Функции-конструкторы технически являются обычными функциями. Но есть два соглашения:
1. Имя функции-конструктора должно начинаться с большой буквы.
1. Функция-конструктор должна выполняться только с помощью оператора "`new`".

Например:
```javascript
function User(name) {
  this.name = name;
  this.isAdmin = false;
}

let user = new User("Jack");

alert(user.name); // Jack
alert(user.isAdmin); // false
```

Когда функция вызывается как `new User(...)`, происходит следующее:
- Создаётся новый пустой объект, и он присваивается `this`.
-	Выполняется тело функции. Обычно оно модифицирует `this`, добавляя туда новые свойства.
-	Возвращается значение `this`.

Другими словами, `new User(...)` делает что-то вроде:
```javascript
function User(name) {
  // this = {};  (неявно)

  // добавляет свойства к this
  this.name = name;
  this.isAdmin = false;

  // return this;  (неявно)
}
```

---

## Проверка на вызов в режиме конструктора: `new.target`

Используя специальное свойство `new.target` внутри функции, мы можем проверить, вызвана ли функция при помощи оператора new или без него.

В случае обычного вызова функции `new.target` будет undefined. Если же она была вызвана при помощи `new`, `new.target` будет равен самой функции.
```javascript
function User() {
  alert(new.target);
}

// без "new":
User(); // undefined

// с "new":
new User(); // function User { ... }
```

---
## Создание методов в конструкторе

Использование конструкторов для создания объектов даёт большую гибкость. Функции-конструкторы могут иметь параметры, определяющие, как создавать объект и что в него записывать.

Конечно, мы можем добавить к `this` не только свойства, но и методы.

Например, `new User(name)` ниже создаёт объект с заданным name и методом `sayHi`:
```javascript
function User(name) {
  this.name = name;

  this.sayHi = function() {
    alert( "Меня зовут: " + this.name );
  };
}

let john = new User("John");

john.sayHi(); // Меня зовут: John

/*
john = {
   name: "John",
   sayHi: function() { ... }
}
*/
```

Для создания сложных объектов есть и более продвинутый синтаксис – классы.

---

## Ссылки

- Конструктор, оператор "new"
	- https://learn.javascript.ru/constructor-new
